<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wireless Room Status (v4)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <style>
        body {
            font-family: 'Pretendard', 'Inter', sans-serif;
            margin: 0;
            overflow-x: hidden;
        }

        /* ë°°ê²½ ì»¨í…Œì´ë„ˆ - ì´ë¯¸ì§€ ë° ì˜¤ë²„ë ˆì´ ì ìš© */
        .bg-container {
            width: 100%;
            min-height: 100vh; /* ë·°í¬íŠ¸ ë†’ì´ ê½‰ ì±„ì›€ */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; /* ì½˜í…ì¸  ì¤‘ì•™ ì •ë ¬ */
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            transition: background-image 0.8s ease-in-out;
            position: relative;
        }
        
        /* ì´ë¯¸ì§€ ìœ„ì— ë°˜íˆ¬ëª… ì˜¤ë²„ë ˆì´ë¥¼ ì”Œì›Œ ê°€ë…ì„± í™•ë³´ */
        .bg-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* 50% íˆ¬ëª…ë„ë¡œ ìˆ˜ì • (ê¸°ì¡´ 0.4) */
            z-index: 1;
        }

        .content-area {
            position: relative;
            z-index: 10; /* ì˜¤ë²„ë ˆì´ ìœ„ë¡œ ì½˜í…ì¸  ì˜¬ë¦¬ê¸° */
            text-align: center;
            color: #ffffff; /* ëª¨ë“  í…ìŠ¤íŠ¸ë¥¼ í°ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
            text-shadow: 1px 1px 3px rgba(0,0,0,0.6); /* ê°€ë…ì„± ìœ„í•œ ê·¸ë¦¼ì */
            width: 100%;
            max-width: 400px;
            padding: 2rem 1rem;
        }

        /* ìƒíƒœë³„ ë°°ê²½ ì´ë¯¸ì§€ */
        .status-good {
            background-image: url('https://i.postimg.cc/LXMKJm5Q/congestion1.jpg'); /* ì‚¬ë°”ë‚˜ */
        }
        .status-medium {
            background-image: url('https://i.postimg.cc/bJjcZqr6/congestion2.jpg'); /* ì‹œê³¨ ê¸°ì°¨ì—­ */
        }
        .status-busy {
            background-image: url('https://i.postimg.cc/W3PLdszQ/congestion3.jpg'); /* ì‚¿í¬ë¡œ ë„ì‹œ */
        }
        .status-very-busy { /* ì¶”ê°€ì ì¸ ë‹¨ê³„, ë‰´ìš• */
            background-image: url('https://i.postimg.cc/hjqWXKhB/congestion4.jpg'); /* ë‰´ìš• */
        }

        /* Open/Closed Line - í°ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
        .line-divider {
            height: 1px;
            background-color: #cbd5e0; /* gray-400, í°ìƒ‰ ë°°ê²½ì— ëŒ€ë¹„ë˜ê²Œ */
            width: 80px;
            margin: 0 1rem;
        }

        /* Tailwind ê¸°ë³¸ê°’ ì˜¤ë²„ë¼ì´ë“œ (ì˜ˆìƒ í˜¼ì¡ë„, ë°ì´í„°ë¡œ ë³´ëŠ” ë™ë°© í…ìŠ¤íŠ¸ ìƒ‰ìƒ) */
        .content-area .text-gray-600 { /* ê¸°ì¡´ íšŒìƒ‰ í…ìŠ¤íŠ¸ë„ í°ìƒ‰ìœ¼ë¡œ */
            color: #d1d5db; /* gray-300 */
        }
        .content-area .text-gray-900 { /* ê¸°ì¡´ ì§„í•œ íšŒìƒ‰ í…ìŠ¤íŠ¸ë„ í°ìƒ‰ìœ¼ë¡œ */
            color: #ffffff;
        }
        .content-area .text-indigo-600 { /* íŠ¹ì • ê°•ì¡° í…ìŠ¤íŠ¸ (ì˜ˆ: ì‹œê°„) ìƒ‰ìƒ ìœ ì§€ */
            color: #a78bfa; /* indigo-400, ì–´ë‘ìš´ ë°°ê²½ì— ë” ì˜ ë³´ì´ê²Œ */
        }
        .content-area .text-gray-400 { /* ìµœê·¼ ì—…ë°ì´íŠ¸ ì‹œê°„ */
            color: #9ca3af; /* gray-400 */
        }
    </style>
</head>
<body>

    <div id="bg-container" class="bg-container status-good">
        <div class="bg-overlay"></div> <div class="content-area">
            <header class="mb-8"> <h1 class="text-5xl font-extrabold tracking-wider">WIRELESS</h1> <p class="text-lg font-semibold">STATUS</p> </header>

            <div class="mb-8"> <p id="status-text" class="text-2xl font-bold mb-2">ì¾Œì </p> <p class="text-base mb-2">í˜„ì¬ ì¸ì›</p> <h2 id="current-count" class="text-5xl font-extrabold">0<span class="text-3xl font-bold ml-1">ëª…</span></h2> <p id="fortune-text" class="text-base mt-4" style="line-height: 1.6;"> 
                    </p>
            </div>

            <div class="mb-8"> <p class="text-lg font-bold mb-2">ì‹œê°„í‘œ ê¸°ì¤€ í˜¼ì¡ë„</p> <p id="prediction-text" class="text-base"> ì§€ê¸ˆì€ 'í•œì‚°'í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.
                </p>
            </div>

            <div class="mb-8"> <p class="text-lg font-bold mb-2">ë°ì´í„°ë¡œ ë³´ëŠ” ë™ë°©</p> <p id="stats-text" class="text-base"> ê°€ì¥ í™œê¸°ì°¬ ì‹œê°„: í‰ì¼ ì˜¤í›„ 4ì‹œ ~ 6ì‹œ
                </p>
            </div>

            <div class="text-center mt-6">
                <span id="last-updated" class="text-xs text-gray-400">
                    ë°ì´í„° ë¡œë”© ì¤‘...
                </span>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
      // [To-Do 1] Firebase config ì •ë³´ë¡œ ì•± ì´ˆê¸°í™”
      const firebaseConfig = {
    apiKey: "AIzaSyCh5IBc9B6H8jipIu_IESVoz0VYg3VCwN8",
    authDomain: "wireless-countpeople.firebaseapp.com",
    databaseURL: "https://wireless-countpeople-default-rtdb.firebaseio.com",
    projectId: "wireless-countpeople",
    storageBucket: "wireless-countpeople.firebasestorage.app",
    messagingSenderId: "891912642045",
    appId: "1:891912642045:web:28df20f3570545660ccd94",
    measurementId: "G-PVSJKSP0C3"
  };
    
      // Firebase ì•± ì´ˆê¸°í™”
      firebase.initializeApp(firebaseConfig);
    
      // Firebase Realtime Database ì„œë¹„ìŠ¤ì— ëŒ€í•œ ì°¸ì¡° ê°€ì ¸ì˜¤ê¸°
      const database = firebase.database();
    </script>


    <script>
        // --- ìƒíƒœë³„ UI ì •ì˜ (ì›ë³¸ íŒŒì¼ì˜ 'states' ë°°ì—´) ---
        // Firebaseì—ì„œ ë°›ì€ 'ì¸ì› ìˆ˜(ìˆ«ì)'ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì–´ë–¤ UIë¥¼ ë³´ì—¬ì¤„ì§€ ê²°ì •í•©ë‹ˆë‹¤.
        
        const uiStates = {
            good: { 
                statusText: "ì¾Œì ", 
                statusClass: "status-good", // ì‚¬ë°”ë‚˜
                predictionText: "ì§€ê¸ˆì€ ë™ì•„ë¦¬ë°©ì´ í•œì‚°í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.",
                mostActiveTime: "í‰ì¼ ì˜¤ì „ (9ì‹œ~12ì‹œ)",
                fortuneText: "ì˜¤ëŠ˜ì€ ìƒˆë¡œìš´ ì•„ì´ë””ì–´ê°€ ìƒ˜ì†ŸëŠ” ë‚ ! ğŸ’¡" 
            },
            medium: { 
                statusText: "ë³´í†µ", 
                statusClass: "status-medium", // ì‹œê³¨ ê¸°ì°¨ì—­
                predictionText: "ì ì‹¬ì‹œê°„ ì´í›„, ì‚¬ëŒì´ ì¡°ê¸ˆì”© ëª¨ì´ê³  ìˆì–´ìš”.",
                mostActiveTime: "í‰ì¼ ì ì‹¬ì‹œê°„ (12ì‹œ~14ì‹œ)",
                fortuneText: "ëœ»ë°–ì˜ ë™ë£Œì™€ ì¦ê±°ìš´ ëŒ€í™”ë¥¼ ë‚˜ëˆ ë³´ì„¸ìš”. â˜•" 
            },
            busy: { 
                statusText: "í˜¼ì¡", 
                statusClass: "status-busy", // ì‚¿í¬ë¡œ
                predictionText: "ë™ì•„ë¦¬ í™œë™ì´ í™œë°œí•œ ì‹œê°„ì´ë¼ ë§¤ìš° ë¶ë¹Œ ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤.",
                mostActiveTime: "í‰ì¼ ì˜¤í›„ (16ì‹œ~19ì‹œ)",
                fortuneText: "í™œê¸°ì°¬ ë¶„ìœ„ê¸° ì†ì—ì„œ ê¸ì •ì ì¸ ì—ë„ˆì§€ë¥¼ ì–»ìœ¼ì„¸ìš”! ğŸ”¥" 
            },
            veryBusy: { 
                statusText: "ë§¤ìš° í˜¼ì¡", 
                statusClass: "status-very-busy", // ë‰´ìš•
                predictionText: "ë™ì•„ë¦¬ë°©ì´ ê±°ì˜ ë§Œì›ì´ì—ìš”! ì´ìš©ì— ì°¸ê³ í•´ì£¼ì„¸ìš”.",
                mostActiveTime: "íŠ¹ì • ì´ë²¤íŠ¸/ëª¨ì„ ì‹œê°„",
                fortuneText: "ì˜¤ëŠ˜ì€ ì ì‹œ íœ´ì‹ì´ í•„ìš”í• ì§€ë„? í‹ˆí‹ˆì´ ìŠ¤íŠ¸ë ˆì¹­! ğŸ§˜" 
            }
        };

        // [To-Do 2] fetchData í•¨ìˆ˜ë¥¼ Firebase ì‹¤ì‹œê°„ êµ¬ë…ìœ¼ë¡œ ë³€ê²½
        function fetchData() {
            // 1. êµ¬ë…í•  ë°ì´í„°ì˜ ìœ„ì¹˜ ('status' ì•„ë˜ 'currentPeople')
            const countRef = database.ref('status/currentPeople');
        
            // 2. on('value', ...) í•¨ìˆ˜ë¡œ ì‹¤ì‹œê°„ êµ¬ë… ì‹œì‘
            //    ë°ì´í„°ê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ (ë˜ëŠ” ì²˜ìŒ ë¡œë“œë  ë•Œ) ì½œë°± í•¨ìˆ˜ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤.
            countRef.on('value', (snapshot) => {
                
                // 3. Firebaseì—ì„œ ì‹¤ì œ ì¸ì›(ìˆ«ì) ê°€ì ¸ì˜¤ê¸°
                const currentPeople = snapshot.val(); 
        
                // 4. ì¸ì› ìˆ˜(ìˆ«ì)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì–´ë–¤ UI ìƒíƒœë¥¼ ì“¸ì§€ ê²°ì •
                let stateKey;
                if (currentPeople <= 5) {       // 0-5ëª…: ì¾Œì 
                    stateKey = 'good'; 
                } else if (currentPeople <= 10) { // 6-10ëª…: ë³´í†µ
                    stateKey = 'medium'; 
                } else if (currentPeople <= 20) { // 11-20ëª…: í˜¼ì¡
                    stateKey = 'busy'; 
                } else {                          // 21+ ëª…: ë§¤ìš° í˜¼ì¡
                    stateKey = 'veryBusy'; 
                }

                // 5. UIì— ì „ë‹¬í•  ìµœì¢… ë°ì´í„° ê°ì²´ ìƒì„±
                const dataForUI = {
                    ...uiStates[stateKey], // ì¾Œì /ë³´í†µ/í˜¼ì¡ ìƒíƒœì˜ ê¸°ë³¸ í…ìŠ¤íŠ¸
                    currentCount: currentPeople, // ì‹¤ì œ ì¸ì› ìˆ˜ë¡œ ë®ì–´ì“°ê¸°
                    lastUpdated: new Date().toISOString() // í˜„ì¬ ì‹œê°„ìœ¼ë¡œ ë®ì–´ì“°ê¸°
                };
        
                // 6. [To-Do 3] UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ í˜¸ì¶œ
                updateUI(dataForUI);
            }, (error) => {
                // (ì„ íƒì‚¬í•­) ë§Œì•½ ë°ì´í„° ì½ê¸°ì— ì‹¤íŒ¨í•˜ë©´ ì½˜ì†”ì— ì—ëŸ¬ë¥¼ ì°ìŠµë‹ˆë‹¤.
                console.error("Firebase ë°ì´í„° ì½ê¸° ì‹¤íŒ¨:", error);
                // í•„ìš”í•˜ë‹¤ë©´ ì—¬ê¸°ì— "ì„œë²„ ì—°ê²° ì‹¤íŒ¨" UIë¥¼ ë³´ì—¬ì£¼ëŠ” ë¡œì§ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            });
        }

        // UIë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜ (ì›ë³¸ íŒŒì¼ì˜ 'updateUI' í•¨ìˆ˜)
        function updateUI(data) {
            const bgContainer = document.getElementById('bg-container');
            const statusTextEl = document.getElementById('status-text');
            const currentCountEl = document.getElementById('current-count');
            const predictionTextEl = document.getElementById('prediction-text');
            const statsTextEl = document.getElementById('stats-text');
            const fortuneTextEl = document.getElementById('fortune-text'); 
            const lastUpdatedEl = document.getElementById('last-updated');

            // ìƒíƒœì— ë”°ë¼ ë°°ê²½ ì´ë¯¸ì§€ ë³€ê²½ (CSS í´ë˜ìŠ¤ êµì²´)
            bgContainer.className = `bg-container ${data.statusClass}`;

            // í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            statusTextEl.textContent = data.statusText;
            currentCountEl.innerHTML = `${data.currentCount}<span class="text-3xl font-bold ml-1">ëª…</span>`;
            predictionTextEl.textContent = data.predictionText;
            statsTextEl.innerHTML = `ê°€ì¥ í™œê¸°ì°¬ ì‹œê°„: ${data.mostActiveTime}`;
            fortuneTextEl.textContent = data.fortuneText; 
            lastUpdatedEl.textContent = `ìµœê·¼ ì—…ë°ì´íŠ¸: ${new Date(data.lastUpdated).toLocaleString('ko-KR')}`;
        }


        // í˜ì´ì§€ê°€ ë¡œë“œë˜ë©´ ì¦‰ì‹œ Firebase ë°ì´í„° êµ¬ë… ì‹œì‘!
        fetchData();

        // (ê¸°ì¡´ì˜ getMockData() ì™€ setInterval(fetchData, 3000)ëŠ” ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.)

    </script>
</body>
</html>